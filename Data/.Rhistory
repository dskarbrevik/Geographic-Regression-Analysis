library(xlsx)
install.packages("rJava",type='source')
install.packages("rJava", type = "source")
library(xlsx)
library(ggplot2)
library(lmtest)
library(car)
library(sandwich)
library("xlsx")
install.packages('rJava', .libPaths()[1], 'http://www.rforge.net/')
library(xlsx)
install.packages("rJava")
install.packages(c("BH", "cluster", "codetools", "curl", "foreign", "hms", "knitr", "lattice", "Matrix", "mgcv", "Rcpp", "rmarkdown", "survival", "yaml"))
library(xlsx)
install.packages("xlsxjars")
library(xlsx)
library(gsheet)
diet.data <- gsheet2tbl('https://docs.google.com/spreadsheets/u/1/d/1W8Bnx48Xz4ybA9PF0XHiNRh3dTtOqcGSZOPOdnat_QE/pub?single=true&gid=0')
diet.data <- read.csv("diet-forcsv - Sheet 1.csv")
setwd('~/Documents/MIDS/w271/w271_final_proj/W271_Lab3/Data')
getwd()
diet.data <- read.csv("diet-forcsv - Sheet 1.csv")
View(diet.data)
install.packages("rJava")
install.packages("rJava")
library(xlsx)
summary(diet.data$Wine..kcal.day.)
sum(diet.data$Wine..kcal.day. == 0)
#There are 32 countries with zero wine consumption. This could be because of bottom coding to cover for null values.
wine.hist <- ggplot(data = diet.data, aes(x = Wine..kcal.day.))
wine.hist + geom_histogram(fill = "navy", colour = "white") + ggtitle("Histogram of Wine Calories per Day") + labs(y = "Number of Countries")
library(ggplot2)
library(lmtest)
library(car)
library(sandwich)
wine.hist <- ggplot(data = diet.data, aes(x = Wine..kcal.day.))
wine.hist + geom_histogram(fill = "navy", colour = "white") + ggtitle("Histogram of Wine Calories per Day") + labs(y = "Number of Countries")
summary(diet.data$Life.expectancy.at.birth..years..both.sexes)
life.expect.all.hist <- ggplot(data = diet.data, aes(x = Life.expectancy.at.birth..years..both.sexes))
life.expect.all.hist + geom_histogram(fill = "navy", colour = "white") + ggtitle("Histogram of Life Expectancy at Birth") + labs(y = "Number of Countries")
summary(diet.data$Alcoholic.Beverages..kcal.day.)
sum(diet.data$Alcoholic.Beverages..kcal.day. < 0)
Alcoholic.bevs.cals.hist <- ggplot(data = diet.data, aes(x = Alcoholic.Beverages..kcal.day.))
Alcoholic.bevs.cals.hist + geom_histogram(fill = "navy", colour = "white") + ggtitle("Histogram of Alchoholic Beverages Calories per Day") + labs(y = "Number of Countries")
summary(diet.data$Gross.national.income.per.capita..PPP.international...)
GNP.hist <- ggplot(data = diet.data, aes(x = Gross.national.income.per.capita..PPP.international...))
GNP.hist + geom_histogram(fill = "navy", colour = "white") + ggtitle("Histogram of GNP") + labs(y = "Number of Countries")
Alcoholic.bevs.cals.hist <- ggplot(data = diet.data, aes(x = Alcoholic.Beverages..kcal.day.))
Alcoholic.bevs.cals.hist + geom_histogram(fill = "navy", colour = "white") + ggtitle("Histogram of Alchoholic Beverages Calories per Day") + labs(y = "Number of Countries")
data.validation.growth_rate <- merge(data.validation.growth_rate, data.validation.country.mapping[,c("Population.Growth.Rate", "Country_main_dataset")], by.x = "Country.Name", by.y = "Population.Growth.Rate")
wine.model.1 <- lm(Life.expectancy.at.birth..years..both.sexes ~ Wine..kcal.day., data = diet.data)
summary(wine.model.1)
plot(wine.model.1)
plot(wine.model.1)
bptest(wine.model.1)
durbinWatsonTest(wine.model.1)
coeftest(wine.model.1, vcov = vcovHC)
cor(diet.data$Healthy.life.expectancy..HALE..at.birth..years..both.sexes, diet.data$Life.expectancy.at.birth..years..both.sexes)
wine.model.1.1 <- lm(diet.data$Healthy.life.expectancy..HALE..at.birth..years..both.sexes ~ Wine..kcal.day., data = diet.data)
summary(wine.model.1.1)
plot(wine.model.1.1)
bptest(wine.model.1.1)
durbinWatsonTest(wine.model.1.1)
alc.model.1 <- lm(Life.expectancy.at.birth..years..both.sexes ~ Alcoholic.Beverages..kcal.day., data = diet.data)
summary(alc.model.1)
coeftest(alc.model.1, vcov = vcovHC)
summary(alc.model.1)
plot(alc.model.1)
bptest(alc.model.1)
durbinWatsonTest(alc.model.1)
alc.model.2 <- lm(Life.expectancy.at.birth..years..both.sexes ~ Alcoholic.Beverages..kcal.day. + Gross.national.income.per.capita..PPP.international..., data = diet.data)
summary(alc.model.2)
coeftest(alc.model.1, vcov = vcovHC)
alc.model.2 <- lm(Life.expectancy.at.birth..years..both.sexes ~ Alcoholic.Beverages..kcal.day. + Gross.national.income.per.capita..PPP.international..., data = diet.data)
summary(alc.model.2)
plot(alc.model.2)
bptest(alc.model.2)
durbinWatsonTest(alc.model.2)
coeftest(alc.model.2, vcov = vcovHC)
alc.model.3 <- lm(Life.expectancy.at.birth..years..both.sexes ~ I(Alcoholic.Beverages..kcal.day.^2) + Alcoholic.Beverages..kcal.day. + Gross.national.income.per.capita..PPP.international..., data = diet.data)
summary(alc.model.3)
plot(diet.data$Life.expectancy.at.birth..years..both.sexes, diet.data$Alcoholic.Beverages..kcal.day.)
summary(lm(Life.expectancy.at.birth..years..both.sexes ~ I(Alcoholic.Beverages..kcal.day.^3) + I(Alcoholic.Beverages..kcal.day.^2) + Alcoholic.Beverages..kcal.day. + Gross.national.income.per.capita..PPP.international..., data = diet.data))
bptest(alc.model.3)
durbinWatsonTest(alc.model.3)
coeftest(alc.model.3, vcov = vcovHC)
diet.data.2 <- diet.data[diet.data$Alcoholic.Beverages..kcal.day. > 0, ]
alc.model.4 <- lm(Life.expectancy.at.birth..years..both.sexes ~ log(Alcoholic.Beverages..kcal.day.) + Gross.national.income.per.capita..PPP.international..., data = diet.data.2)
summary(alc.model.4)
plot(alc.model.4)
coeftest(alc.model.4, vcov = vcovHC)
coeftest(alc.model.4, vcov = vcovHC)
alc.model.5 <- lm(Life.expectancy.at.birth..years..both.sexes ~ log(Alcoholic.Beverages..kcal.day.) + log(Gross.national.income.per.capita..PPP.international...), data = diet.data.2)
summary(alc.model.5)
plot(alc.model.5)
bptest(alc.model.5)
durbinWatsonTest(alc.model.5)
coeftest(alc.model.5, vcov = vcovHC)
durbinWatsonTest(alc.model.5)
bptest(alc.model.5)
plot(diet.data$Life.expectancy.at.birth..years..both.sexes, diet.data$Alcoholic.Beverages..kcal.day.)
plot(diet.data$Life.expectancy.at.birth..years..both.sexes, log(diet.data$Alcoholic.Beverages..kcal.day.))
plot(log(diet.data$Alcoholic.Beverages..kcal.day.), diet.data$Life.expectancy.at.birth..years..both.sexes)
cor(diet.data$Wine..kcal.day., diet.data$Life.expectancy.at.birth..years..both.sexes)
cor(diet.data$Alcoholic.Beverages..kcal.day., diet.data$Life.expectancy.at.birth..years..both.sexes)
cor(diet.data$Gross.national.income.per.capita..PPP.international..., diet.data$Wine..kcal.day.)
cor(diet.data$Gross.national.income.per.capita..PPP.international..., diet.data$Alcoholic.Beverages..kcal.day.)
wine.gnp.scatter <- ggplot(data = diet.data, aes(x = Gross.national.income.per.capita..PPP.international..., y = Wine..kcal.day.))
wine.gnp.scatter + geom_point(colour = "navy") + ggtitle("Scatterplot of GNP and Wine Consumption per Day")
par(mfrow=c(3,1))
plot(d$Wine..kcal.day., d$Life.expectancy.at.birth..years..male, main="Life Expectancy (males) vs Wine Consumption", xlab="Wine (kcal/day)", ylab="Life Expectancy (male)")
plot(d$Wine..kcal.day., d$Life.expectancy.at.birth..years..female, main="Life Expectancy (female) vs Wine Consumption", xlab="Wine (kcal/day)", ylab="Life Expectancy (female)")
plot(d$Wine..kcal.day., d$Life.expectancy.at.birth..years..both.sexes, main="Life Expectancy  vs Wine Consumption", xlab="Wine (kcal/day)", ylab="Life Expectancy")
d <- gsheet2tbl('https://docs.google.com/spreadsheets/u/1/d/1W8Bnx48Xz4ybA9PF0XHiNRh3dTtOqcGSZOPOdnat_QE/pub?single=true&gid=0')
library(gsheet)
d <- gsheet2tbl('https://docs.google.com/spreadsheets/u/1/d/1W8Bnx48Xz4ybA9PF0XHiNRh3dTtOqcGSZOPOdnat_QE/pub?single=true&gid=0')
par(mfrow=c(3,1))
plot(d$Wine..kcal.day., d$Life.expectancy.at.birth..years..male, main="Life Expectancy (males) vs Wine Consumption", xlab="Wine (kcal/day)", ylab="Life Expectancy (male)")
plot(d$Wine..kcal.day., d$Life.expectancy.at.birth..years..female, main="Life Expectancy (female) vs Wine Consumption", xlab="Wine (kcal/day)", ylab="Life Expectancy (female)")
plot(d$Wine..kcal.day., d$Life.expectancy.at.birth..years..both.sexes, main="Life Expectancy  vs Wine Consumption", xlab="Wine (kcal/day)", ylab="Life Expectancy")
le.cat <- cut(d$Life.expectancy.at.birth..years..both.sexes, c(0,10,20,30,40,50,60,70,80,90)) #create categorical ranges from life expectancy column
plot(by(d$Wine..kcal.day., le.cat, mean), main="Wine consumption by Life Expectancy", ylab="Average Wine Consumption", xlab="Age Range", xaxt = "n")
axis(1, at = c(1:9), labels=c("0-10","11-20","21-30","31-40","41-50","51-60","61-70","71-80","81-90"))
par(mfrow=c(1,1))
le.cat <- cut(d$Life.expectancy.at.birth..years..both.sexes, c(0,10,20,30,40,50,60,70,80,90)) #create categorical ranges from life expectancy column
plot(by(d$Wine..kcal.day., le.cat, mean), main="Wine consumption by Life Expectancy", ylab="Average Wine Consumption", xlab="Age Range", xaxt = "n")
i = 52
wine.box <- boxplot(d[i])
df <- cbind(d[i], countries, d$Life.expectancy.at.birth..years..both.sexes)
countries <- d$Countries
wine.box <- boxplot(d[i])
df <- cbind(d[i], countries, d$Life.expectancy.at.birth..years..both.sexes)
names(df) <- c("wine_consumption", "countries", "life_expectancy")
ordered_df <- df[order(df[1]),]
ordered_df[ordered_df$wine_consumption > wine.box$stats[5],] #every country with high wine consumption has a life expectancy of over 70.
boxplot(d[i])
d[i]
i = 52
wine.box <- boxplot(diet.data[i])
df <- cbind(diet.data[i], diet.data$Countries, diet.data$Life.expectancy.at.birth..years..both.sexes)
names(df) <- c("wine_consumption", "countries", "life_expectancy")
ordered_df <- df[order(df[1]),]
ordered_df[ordered_df$wine_consumption > wine.box$stats[5],] #every country with high wine consumption has a life expectancy of over 70.
i = 27
alc.box <- boxplot(diet.data[i])
alc.df <- cbind(diet.data[i], diet.data$Countries, diet.data$Life.expectancy.at.birth..years..both.sexes)
names(alc.df) <- c("alcohol_consumption", "countries", "life_expectancy")
alc.ordered_df <- alc.df[order(alc.df[1]),]
alc.ordered_df[alc.ordered_df$alcohol_consumption > alc.box$stats[5],]
alc.box <- boxplot(diet.data[i])
boxplot(diet.data[27])
diet.data[27]
alc.box
alc.df <- cbind(diet.data[i], diet.data$Countries, diet.data$Life.expectancy.at.birth..years..both.sexes)
alc.df
names(alc.df) <- c("alcohol_consumption", "countries", "life_expectancy")
alc.df
alc.ordered_df <- alc.df[order(alc.df[1]),]
alc.ordered_df
alc.ordered_df[alc.ordered_df$alcohol_consumption > alc.box$stats[5],]
alc.box$stats[5]
alc.box$stats
wine.box <- boxplot(diet.data[i])
df <- cbind(diet.data[i], diet.data$Countries, diet.data$Life.expectancy.at.birth..years..both.sexes)
names(df) <- c("wine_consumption", "countries", "life_expectancy")
ordered_df <- df[order(df[1]),]
ordered_df[ordered_df$wine_consumption > wine.box$stats[5],]
i = 52
wine.box <- boxplot(diet.data[i])
df <- cbind(diet.data[i], diet.data$Countries, diet.data$Life.expectancy.at.birth..years..both.sexes)
names(df) <- c("wine_consumption", "countries", "life_expectancy")
ordered_df <- df[order(df[1]),]
ordered_df[ordered_df$wine_consumption > wine.box$stats[5],]
i = 52
wine.box <- boxplot(diet.data[i])
wine.box <- boxplot(diet.data[i], main = "Boxplot of Wine Consumtion, by Country")
wine.box <- boxplot(diet.data[i], main = "Boxplot of Wine Consumtion (kcal/day)")
df <- cbind(diet.data[i], diet.data$Countries, diet.data$Life.expectancy.at.birth..years..both.sexes)
names(df) <- c("wine_consumption", "countries", "life_expectancy")
ordered_df <- df[order(df[1]),]
ordered_df[ordered_df$wine_consumption > wine.box$stats[5],]
summary(diet.data$Life.expectancy.at.birth..years..both.sexes)
life.expect.all.hist <- ggplot(data = diet.data, aes(x = Life.expectancy.at.birth..years..both.sexes))
life.expect.all.hist + geom_histogram(fill = "navy", colour = "white") + ggtitle("Histogram of Life Expectancy at Birth") + labs(y = "Number of Countries")
cor(diet.data$Wine..kcal.day., diet.data$Life.expectancy.at.birth..years..both.sexes)
